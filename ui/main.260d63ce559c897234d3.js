(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{0:function(t,e){},1:function(t,e,n){t.exports=n("zUnb")},2:function(t,e){},3:function(t,e){},RnhZ:function(t,e,n){var r={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-SG":"zavE","./en-SG.js":"zavE","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./ga":"USCx","./ga.js":"USCx","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it-ch":"bxKX","./it-ch.js":"bxKX","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ku":"JCF/","./ku.js":"JCF/","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function o(t){var e=s(t);return n(e)}function s(t){var e=r[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}o.keys=function(){return Object.keys(r)},o.resolve=s,t.exports=o,o.id="RnhZ"},VcIq:function(t,e){t.exports=""},crnd:function(t,e){function n(t){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="crnd"},"k/xC":function(t,e){t.exports="<router-outlet></router-outlet>\r\n"},oyxX:function(t,e){t.exports='<div class="container-fluid">\r\n    <span class="version_span"><b>AmaVat {{pluginVersion}}</b></span>\r\n    <div class="row">\r\n        <div class="form-div">\r\n            <label for="dateFrom">Month:</label>\r\n            <input type="month" name="date" #dateFrom="ngModel" [ngModel]="model.date | date:\'yyyy-MM\'" (ngModelChange)="model.date = $event" required>\r\n            <div *ngIf="dateFrom.invalid && (dateFrom.dirty || dateFrom.touched)" class="validation-error">\r\n                <div *ngIf="dateFrom.errors.required">Month is required.</div>\r\n            </div>\r\n        </div>\r\n        <br />\r\n    </div>\r\n\r\n    <div class="row">\r\n        <div class="form-div">\r\n            <label>Order status:</label>\r\n            <br />\r\n            <ng-multiselect-dropdown [placeholder]="\'Select status\'"\r\n                                     [settings]="dropdownSettings"\r\n                                     [data]="statuses"\r\n                                     [(ngModel)]="model.selectedItems"\r\n                                     name="statusDropdown"\r\n                                     #statusDropdown="ngModel"\r\n                                     required>\r\n            </ng-multiselect-dropdown>\r\n            <div *ngIf="statusDropdown.invalid && (statusDropdown.dirty || statusDropdown.touched)" class="validation-error">\r\n                <div *ngIf="statusDropdown.errors.required">Status is required.</div>\r\n            </div>\r\n            <div class="validation-error" *ngIf="showStatusError">You have to select at least one status</div>\r\n        </div>\r\n        <br />\r\n    </div>\r\n\r\n    <div class="form-div center-text button-div">\r\n        <button class="button" (click)="generate()">Generate</button>\r\n    </div>\r\n\r\n    <div class="form-div center-text">\r\n        <label class="status" style="color:orange" *ngIf="isGenerating && !isGenerated">{{status}}</label>\r\n        <label class="status" style="color:green" *ngIf="isGenerated">Generated</label>\r\n        <label class="status" style="color:red" *ngIf="errorOccured">{{errorMessage}}</label>\r\n    </div>\r\n</div>\r\n'},ygTa:function(t,e){t.exports=".version_span {\n  margin-left: 30px;\n  font-size: medium;\n  margin-bottom: -40px; }\n\n.form-div {\n  width: 30%;\n  margin: auto;\n  margin-top: 15px; }\n\n.form-div > input {\n    float: right;\n    width: 70%;\n    margin: 10px; }\n\n.form-div > select {\n    float: right;\n    width: 70%;\n    margin: 10px; }\n\n.form-div > label {\n    width: auto;\n    margin: 10px;\n    margin-bottom: 0px; }\n\n.status {\n  width: 80% !important;\n  margin: -1px;\n  margin-top: 20px;\n  text-align: center; }\n\n.validation-error {\n  color: red;\n  text-align: right; }\n\n.ml-20 {\n  margin-left: 20px; }\n\n.button {\n  margin: 10px;\n  width: 10%; }\n\n.center-text {\n  text-align: center; }\n\n.button-div {\n  width: 100%;\n  display: -webkit-box;\n  display: flex;\n  -webkit-box-pack: center;\n          justify-content: center; }\n\n.container-fluid {\n  margin: 10px;\n  width: 90%; }\n\n::ng-deep .big-div {\n  width: 100% !important;\n  max-width: 100% !important; }\n\n::ng-deep .big-div select {\n    width: 70% !important;\n    margin: 10px !important; }\n\n::ng-deep .big-div label {\n    margin: 10px !important; }\n"},zUnb:function(t,e,n){"use strict";n.r(e);var r=n("CcnG"),o=n("ToYH"),s={production:!0},i=n("mrSG"),a=n("ZYjt"),c=n("sE5F"),u=n("up6G"),d=n("gIcY"),l=function(){var t=localStorage.getItem("plentymarkets_lang_"),e=null;null!==t?e=t:("de"!==(e=navigator.language.slice(0,2).toLocaleLowerCase())&&"en"!==e&&(e="en"),localStorage.setItem("plentymarkets_lang_",e));return{locale:{languages:[{code:"en",dir:"ltr"},{code:"de",dir:"ltr"}],language:e,storage:u.StorageStrategy.Cookie},translation:{providers:[{type:u.ProviderType.Static,prefix:"assets/lang/locale-"},{type:u.ProviderType.Static,prefix:"assets/lang/terra-components/locale-"}],caching:!0,composedKeySeparator:".",i18nPlural:!1}}}();var p=n("t/Na"),f=n("ZYCi"),h=n("MnON"),m=n("wFw1"),g=function(t){function e(e,n,r){var o=t.call(this,new p.HttpClient(e),n,r)||this;return o.httpBackend=e,o}return i.d(e,t),e=i.c([Object(r.Injectable)(),i.g(1,Object(r.Inject)(u.L10N_CONFIG)),i.f("design:paramtypes",[p.HttpBackend,Object,u.Caching])],e)}(u.L10nTranslationProvider),v=n("XlPw"),y=n("5tAl"),j=n("9Z1F"),I=function(){function t(){}return t.prototype.intercept=function(t,e){return e.handle(t).pipe(Object(y.a)(1),Object(j.a)(function(t){var e="";return e=t.error instanceof ErrorEvent?"Error: "+t.error.message:"Error Code: "+t.status+"\nMessage: "+t.message,console.log(e),Object(v.a)(e)}))},t}(),b=function(){function t(){this.accessToken="eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIxIiwianRpIjoiMzIwYWUzOTQyM2FlNjI0MjYwY2Y4YWI0ZDc1M2FiNGY3NTY2ZjEzNzI0MGU4MmFiYzMwYmYwMDQyNTJhNDY2MWY4MTBmMTFjMWZmYmE1N2YiLCJpYXQiOjE2MzAzOTc0NjQsIm5iZiI6MTYzMDM5NzQ2NCwiZXhwIjoxNjMwNDgzODY0LCJzdWIiOiI1NyIsInNjb3BlcyI6WyIqIl19.SgMGmH_jb9uViI_JDFUQOBSaRV2m21XZzNVEz5Sgh2_NEmYhZrLNsINgoPRNJ1PTHzOnEcv_qTn9wn_SDCZo5op1KwKx2jLgs78ITDIb3ZYspqL3i8pzbjbQOyWH1MfY3jfdacyDrcYwEc1rgaUoT9hos7-q9HzL62TcAVGHx_dZoNSDyx7gs7QuJsGv4axoY8xy2M0i36Uzlj868kFHTS_ZITOdaQzUMA-xM58a0pC8Q9dZLQoCGfT9q6JUsvUJSQVYUSqL05o52vlO_sGQQnblNwFJ3ZCQ9Uhp8rY_J856Prk0-2rB3YIV6yBgsCS4UKx-iE_A05jR0fEzBKTH94OQKQBiQi3G_gL1iVKdqfdLTmX3T8zwirN-P9ODRBZrMnz48lSyhDKU_UkUn3LeeCqdrosueP4qiAB47DZLrIFwziTN5vsIFH8L6d8Idj4z60gpYT1VXs9NdG-AKqfMtzNrQHT7JxIVUelDUkif2NFfV_VfUh_82mNbqV9taWkE8W7EmhuuamXtqmKZ_G4z4wDMFSwBPDgz8hfeDuUioYyYpBwi3ojPdvwRr6p-qjxLYpPveMNwh8J63tKvCgeFC9VcuEAh27rBPnShCz4crl-IWaYW_C6KKOD-wzNBIW6Mrp9kpgaDpuSG7DZtt3-pcA9dGITCfg9J8UfpZWSI2pI"}return t.prototype.ngOnInit=function(){s.production||localStorage.setItem("accessToken",this.accessToken)},t=i.c([Object(r.Component)({selector:"ptb-app",template:n("k/xC"),styles:[n("VcIq")]}),i.f("design:paramtypes",[])],t)}(),S=(function(){}(),function(){return function(){this.selectedItems=new Array}}()),O=(function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),n("EUZL")),E=function(){return function(){}}(),D=function(){function t(){}return t.DATE_FORMAT="yyyy-MM-dd",t.PERIOD_DATE_FORMAT="yyyy-MM",t.MAX_ITEMS_PER_PAGE=250,t.SHIPPING_ADDRESS_TYPE_ID=2,t.DATE_LOCALE="pl-PL",t.ORIGINAL_ORDER_TYPE_ID=-999,t.USED_DOCUMENTS=["invoice","invoice_external","pos_invoice","credit_note","pos_invoice_cancellation","refund_reversal","reversal_document"],t.SELL_DOCUMENTS=["invoice","invoice_external","pos_invoice"],t.REFUND_DOCUMENTS=["credit_note","pos_invoice_cancellation","refund_reversal","reversal_document"],t.TAX_COLLECTION_RESPONSIBILITY="SELLER",t.TYPE_SERVICE_PROVISION="Goods",t.SENT_FROM_ZIP="",t.PURCHASE_PRICE="",t}(),w=n("Ip0R");function _(t,e){void 0===e&&(e=D.DATE_FORMAT);try{return Object(w.formatDate)(t,e,D.DATE_LOCALE)}catch(n){return"<Invalid Date>"+t}}function T(t,e){var n=t.addressRelations.filter(function(t){return t.typeId===e});if(n.length>0){var r=t.addresses.filter(function(t){return t.id===n[0].addressId});return r.length>0?r[0]:void 0}}function M(t){switch(t){case 2:return"AT";case 3:return"BE";case 44:return"BG";case 54:return"HR";case 5:return"CY";case 6:return"CZ";case 7:return"DK";case 9:return"EE";case 10:return"FR";case 11:return"FI";case 1:return"DE";case 13:return"GR";case 14:return"HU";case 15:return"IT";case 16:return"IE";case 18:return"LV";case 33:return"LT";case 17:return"LU";case 19:return"MT";case 21:return"AW";case 23:return"Pl";case 22:return"PT";case 41:return"RO";case 26:return"SK";case 27:return"SI";case 8:return"ES";case 24:return"SE";case 12:return"UK";default:return""}}function x(t,e){var n=t.dates.filter(function(t){return t.typeId==e});return 0==n.length?"":_(n[0].date)}function C(t,e,n,r,o,s){var i=new E;i.period=n,i.transactionChannel=t.referrerId.toString(),i.transactionNumber=t.id.toString();var a,c=D.SELL_DOCUMENTS.indexOf(r.type)>-1;if(i.transactionType=c?"SELL":"REFUND",i.typeServiceProvision=D.TYPE_SERVICE_PROVISION,i.sentFromCountry=M((a=t).warehouseSender&&a.warehouseSender.address?a.warehouseSender.address.countryId:-1),i.sentFromZIP="",i.sentToCountry=M(function(t){var e=T(t,D.SHIPPING_ADDRESS_TYPE_ID);return e?e.countryId:-1}(t)),i.documentDate=_(r.displayDate),i.documentNumber=r.numberWithPrefix,c)i.correctedDocumentNo="",i.correctedDocumentDate="";else{var u=t.orderReferences.length>0?t.orderReferences[0].originOrderId:void 0,d=o.filter(function(t){return t.id==u});if(d.length>0)if(d[0].documents.filter(function(t){return D.SELL_DOCUMENTS.indexOf(t.type)>-1}).length>0){var l=d[0].documents.filter(function(t){return"invoice"==t.type}).sort(function(t,e){return new Date(e.displayDate).getTime()-new Date(t.displayDate).getTime()}).slice(-1)[0];i.correctedDocumentNo=l.numberWithPrefix,i.correctedDocumentDate=_(l.displayDate)}else 0==d[0].documents.filter(function(t){return"invoice"==t.type}).length?(i.correctedDocumentNo="[Original order does not have invoice]",i.correctedDocumentDate="[Original order does not have invoice]"):(i.correctedDocumentNo="[wtf]",i.correctedDocumentDate="[wtf]");else i.correctedDocumentNo="[Unable to find original order]",i.correctedDocumentDate="[Unable to find original order]"}i.transactionOrderDate=x(t,2),i.transactionShipmentDate=x(t,8),i.transactionPaymentDate=x(t,3),i.transactionDeliveryDate=x(t,11),e.variation?i.itemUnit=e.variation.name:i.itemUnit="",i.itemQuantity=e.quantity,e.variation?i.itemNumber=e.variation.number:i.itemNumber="",i.itemDescription=e.orderItemName;var p=e.amounts.length>0?e.amounts[0]:void 0;if(p){i.totalPriceofItems=c?e.quantity*p.priceGross:-1*e.quantity*p.priceGross,i.taxableBenefits1=0,i.taxableBenefits2=0,i.totalTransactionValue=i.totalPriceofItems,i.transactionCurrency=p.currency;var f=t.amounts.length>0&&t.amounts[0].vats.length>0?t.amounts[0].vats[0]:void 0;f&&(i.vATRate=f.vatRate)}i.purchasePrice="";var h,m,g=t.contactReceiver,v=T(t,D.SHIPPING_ADDRESS_TYPE_ID);if(g.accounts&&1===g.accounts.length){var y=g.accounts[0];i.buyerName=null!=y.companyName?y.companyName+" ":"",i.buyerVatId=y.taxIdNumber}return i.buyerName?i.buyerName+=g.firstName+" "+g.lastName:i.buyerName=g.firstName+" "+g.lastName,i.buyerAddress1=v.address1,i.buyerAddress2=v.address2,i.buyerZIP=v.postalCode,i.buyerCity=v.town,i.buyerCounty=v.stateId,i.buyerCountry=M(v.countryId),e.variation?(i.commodityCode=e.variation.customsTariffNumber,i.weight=e.variation.weightNetG.toString()):(i.commodityCode="",i.weight=""),i.countryOfOrigin="",i.incotermsCode="",i.sellerVatId="",i.sellerName=(h=t.properties,1===(m=h.filter(function(t){return 10===t.typeId})).length?m[0].value:""),i.taxCollectionResponsibility=D.TAX_COLLECTION_RESPONSIBILITY,i}function N(t,e,n,r,o){var s=function(t,e,n,r,o){var s=new Array;return r.setHours(23,59,59),t.filter(function(t){return t.typeId!=D.ORIGINAL_ORDER_TYPE_ID}).forEach(function(o){o.documents.filter(function(t){return D.USED_DOCUMENTS.indexOf(t.type)>-1&&new Date(t.displayDate)>=n&&new Date(t.displayDate)<=r}).forEach(function(n){o.orderItems.forEach(function(r){s.push(C(o,r,e,n,t))})})}),s}(e,t,n,r),i=O.utils.book_new();O.utils.sheet_add_json(i,s);var a=O.utils.book_new();O.utils.book_append_sheet(a,i,t);var c,u,d,l,p=a.Sheets[a.SheetNames[0]],f=O.utils.sheet_to_csv(p,{FS:";"});c=f,u=t+".csv",d="text/csv;encoding:utf-8",l=document.createElement("a"),d=d||"application/octet-stream",navigator.msSaveBlob?navigator.msSaveBlob(new Blob([c],{type:d}),u):URL&&"download"in l?(l.href=URL.createObjectURL(new Blob([c],{type:d})),l.setAttribute("download",u),document.body.appendChild(l),l.click(),document.body.removeChild(l)):location.href="data:application/octet-stream,"+encodeURIComponent(c)}var R=n("BAOO"),A=n.n(R),P=n("VNr4");function U(t){var e=t.getFullYear(),n=t.getMonth(),r=(++n).toString();n<10&&(r="0"+n);var o=t.getDate(),s=o.toString();o<10&&(s="0"+o);var i=t.getHours(),a=i.toString();i<10&&(a="0"+i);var c=t.getMinutes(),u=c.toString();c<10&&(u="0"+c);var d=t.getSeconds(),l=d.toString();d<10&&(l="0"+d);var p=-t.getTimezoneOffset(),f=Math.abs(Math.floor(p/60)),h=f.toString();f<10&&(h="0"+f);var m=Math.abs(p)-60*f,g=m.toString();m<10&&(g="0"+m);var v="+";return p<0&&(v="-"),e+"-"+r+"-"+s+"T"+a+":"+u+":"+l+v+h+":"+g}var k=n("xMyE"),z=function(){function t(t){this.httpClient=t,this.TestBaseUrl="https://6ost41vkg5r1.plentymarkets-cloud01.com/rest/",this.PlentyBaseUrl="",s.production?this.PlentyBaseUrl=this.preparePlentyBaseUrl():this.PlentyBaseUrl=this.TestBaseUrl}return t.prototype.getOrderData=function(t,e,n,r,o,s,i,a){return void 0===i&&(i=!1),void 0===a&&(a=!1),this.getFromApi(this.prepareOrderUrl(o,s,n,r,t,e,i)).pipe(Object(k.a)(function(t){t.isUpdatedAt=i,t.isCreditNote=a}))},t.prototype.getAccounts=function(){return this.getFromApi("accounts")},t.prototype.getPaymentMethodList=function(){return this.getFromApi("payments/methods")},t.prototype.getOrderReferrerList=function(){return this.getFromApi("orders/referrers")},t.prototype.getOrderByIdv2=function(t){return this.httpClient.get(this.getMethodUrl("orders/"+t+"?with[]=documents&with[]=addresses&with[]=contactReceiver&with[]=warehouseSender&with[]=payments&with[]=orderItems.variation"),{responseType:"json"})},t.prototype.getOrderById=function(t){return this.getFromApi("orders/"+t+"?with[]=documents&with[]=addresses&with[]=contactReceiver&with[]=warehouseSender&with[]=payments&with[]=orderItems.variation&with[]=contactSender")},t.prototype.getStatuses=function(){return this.getFromApi("orders/statuses/all")},t.prototype.preparePlentyBaseUrl=function(){var t=window.location.href.split("/");return t[0]+"//"+t[2]+"/rest/"},t.prototype.getFromApi=function(t){return this.httpClient.get(this.getMethodUrl(t),{responseType:"json"})},t.prototype.getMethodUrl=function(t){return""+this.PlentyBaseUrl+t},t.prototype.prepareOrderUrl=function(t,e,n,r,o,s,i){var a="orders?page="+t+"&itemsPerPage="+e;return r.setHours(23,59,59),a+=i?"&updatedAtFrom="+encodeURIComponent(U(n))+"&updatedAtTo="+encodeURIComponent(U(r)):"&createdAtFrom="+encodeURIComponent(U(n))+"&createdAtTo="+encodeURIComponent(U(r)),a+="&statusTo="+s+"&statusFrom="+o,a+="&with[]=addresses",a+="&with[]=documents",a+="&with[]=contactReceiver",a+="&with[]=warehouseSender",a+="&with[]=payments",a+="&with[]=orderItems.variation"},t=i.c([Object(r.Injectable)(),i.f("design:paramtypes",[p.HttpClient])],t)}(),L=n("HJBe"),Y=function(){function t(t,e,n){this.alertService=t,this.ngZone=e,this.amaService=n,this.pluginVersion="0.5.0",this.model=new S,this.isGenerating=!1,this.isGenerated=!1,this.errorOccured=!1,this.expectedOrderCount=0,this.errorMessage="",this.status="Getting orders...",this.orders=new Array,this.dropdownSettings={},this.statuses=new Array,this.accounts=new Array,this.isLoading=!0}return t.prototype.ngOnInit=function(){var t=this;this.amaService.getAccounts().subscribe(function(e){return t.accounts=e}),this.getStatusList(),this.setStatusDropdownSettings(),Object(w.registerLocaleData)(A.a);var e=new Date;this.model.date=e.getFullYear()+"-"+(e.getMonth()+1)},t.prototype.generate=function(){this.setGeneratingVariables(),this.isGenerating=!0,this.getAllOrdersAndGenerateExcel()},t.prototype.getAllOrdersAndGenerateExcel=function(){var t=this,e=new Date(this.model.date+"-1"),n=new Date(e.getFullYear(),e.getMonth()+1,0),r=[],o=this.getStatusFrom().id,s=this.getStatusTo().id,a=[],c=this.addDays(e,-10),u=this.addDays(n,10),d=!1;s>=11.1&&(d=!0),a.push(this.amaService.getOrderData(o,s,c,u,1,D.MAX_ITEMS_PER_PAGE)),a.push(this.amaService.getOrderData(o,s,c,u,1,D.MAX_ITEMS_PER_PAGE,!0)),d&&a.push(this.amaService.getOrderData(11.1,11.1,e,n,1,D.MAX_ITEMS_PER_PAGE,!0,!0)),Object(P.a)(a).pipe(Object(L.a)(null)).subscribe(function(a){a.forEach(function(e){if(t.expectedOrderCount+=e.totalsCount,t.orders=t.orders.concat(e.entries),e.totalsCount>D.MAX_ITEMS_PER_PAGE){var n=Math.ceil((e.totalsCount-D.MAX_ITEMS_PER_PAGE)/D.MAX_ITEMS_PER_PAGE);e.isUpdatedAt?e.isCreditNote?t.getRestOfOrders(11.1,11.1,c,u,n,D.MAX_ITEMS_PER_PAGE,!0).pipe(Object(L.a)(null)):r.push(t.getRestOfOrders(o,s,c,u,n,D.MAX_ITEMS_PER_PAGE,!0).pipe(Object(L.a)(null))):r.push(t.getRestOfOrders(o,s,c,u,n,D.MAX_ITEMS_PER_PAGE).pipe(Object(L.a)(null)))}}),Object(P.a)(r).pipe(Object(L.a)(null)).subscribe(function(){t.hasDuplicates(t.orders)&&(t.orders=t.orders.filter(function(t,e,n){return n.findIndex(function(e){return e.id===t.id})===e}));var r=t.model.selectedItems.map(function(t){return t.id}),o=t.orders.filter(function(t){return r.indexOf(t.statusId)>-1});t.updateStatus("Getting original orders for credit notes");var s=o.filter(function(t){return t.documents.filter(function(e){return D.REFUND_DOCUMENTS.indexOf(e.type)>-1&&t.orderReferences.length>0}).length>0}).map(function(t){return t.orderReferences[0].originOrderId});s=s.filter(function(t){return-1===o.indexOf(t)}),i.b(t,void 0,void 0,function(){var t,e,n=this;return i.e(this,function(r){switch(r.label){case 0:t=function(){var t,r;return i.e(this,function(i){switch(i.label){case 0:return t=s.slice(0,150),r=[],t.forEach(function(t){r.push(n.amaService.getOrderByIdv2(t).toPromise())}),[4,Promise.all(r).finally(function(){n.updateStatus("Getting original orders for credit notes ("+s.length+" left)")})];case 1:return i.sent().forEach(function(t){var e=t;s=s.filter(function(t){return t!=e.id}),e.typeId=D.ORIGINAL_ORDER_TYPE_ID,o.push(e)}),s.length>0?[4,e.delay(6e4,s.length)]:[3,3];case 2:i.sent(),i.label=3;case 3:return[2]}})},e=this,r.label=1;case 1:return s.length>0?[5,t()]:[3,3];case 2:return r.sent(),[3,1];case 3:return[2]}})}).then(function(){if(t.updateStatus("Generating csv"),0!==o.length){t.hasDuplicates(o)&&(o=o.filter(function(t,e,n){return n.findIndex(function(e){return e.id===t.id})===e}));try{N(t.model.date,o,e,n,t.accounts),t.isGenerating=!1,t.isGenerated=!0,t.orders=new Array,t.expectedOrderCount=0}catch(r){t.setError("Unhandled exception occured in excel generation",r)}}else t.setError("No orders found")})},function(t){throw console.log(t),t})},function(){return t.setError("Error fetching orders")},function(){return t.updateStatus()})},t.prototype.delay=function(t,e){return this.updateStatus("Waiting "+t/1e3+" sec to avoid API throtling ("+e+" orders left)"),new Promise(function(e){return setTimeout(e,t)})},t.prototype.addDays=function(t,e){var n=new Date(t);return n.setDate(n.getDate()+e),n},t.prototype.setGeneratingVariables=function(){this.isGenerating=!1,this.isGenerated=!1,this.errorOccured=!1,this.errorMessage=""},t.prototype.setStatusDropdownSettings=function(){this.dropdownSettings={singleSelection:!1,idField:"id",textField:"text",selectAllText:"Select all",unSelectAllText:"Unselect all",itemsShowLimit:15,allowSearchFilter:!1}},t.prototype.getStatusList=function(){var t=this;this.amaService.getStatuses().subscribe(function(e){var n=e.sort(function(t,e){return t.statusId-e.statusId}),r=[];n.forEach(function(e){r.push({id:e.statusId,text:t.getStatusNameString(e)})}),t.statuses=r},function(){t.setError("Unable to get status list form API")})},t.prototype.getStatusTo=function(){return this.model.selectedItems.sort(function(t,e){return e.id-t.id})[0]},t.prototype.getStatusFrom=function(){return this.model.selectedItems.sort(function(t,e){return t.id-e.id})[0]},t.prototype.getRestOfOrders=function(t,e,n,r,o,s,i){var a=this;void 0===i&&(i=!1);for(var c=[],u=1;u<=o;u++)c.push(this.amaService.getOrderData(t,e,n,r,1+u,s,i).pipe(Object(k.a)(function(t){a.orders=a.orders.concat(t.entries)},function(){},function(){return a.updateStatus()})));return Object(P.a)(c)},t.prototype.hasDuplicates=function(t){var e=new Set;return t.some(function(t){return e.size===e.add(t.id).size})},t.prototype.setError=function(t,e){void 0===e&&(e=void 0),this.setGeneratingVariables(),this.errorOccured=!0,this.errorMessage=t,this.alertService.error(t),e&&console.log(e)},t.prototype.updateStatus=function(t){var e=this;if(void 0===t&&(t=void 0),t)this.ngZone.run(function(){e.status=t});else{var n=0!==this.expectedOrderCount?Math.round(this.orders.length/this.expectedOrderCount*100):0;this.ngZone.run(function(){e.status=0!==e.expectedOrderCount?"Getting orders... ("+n+"%)":"Getting orders..."})}},t.prototype.getStatusNameString=function(t){return t.names.en?t.names.en:t.names.de},t=i.c([Object(r.Component)({selector:"amavat",template:n("oyxX"),styles:[n("ygTa")]}),i.f("design:paramtypes",[h.AlertService,r.NgZone,z])],t)}(),G=[{path:"",component:Y}],F=[],B=f.RouterModule.forRoot(G,{useHash:!0}),V=n("5NQ/"),Z=n("SMsm"),Q=function(){function t(t){this.l10nLoader=t,this.l10nLoader.load()}return t=i.c([Object(r.NgModule)({imports:[a.a,m.b,c.HttpModule,d.FormsModule,p.HttpClientModule,u.TranslationModule.forRoot(l,{translationProvider:g}),f.RouterModule.forRoot([]),h.TerraComponentsModule,B,Z.a,V.a.forRoot()],declarations:[b,Y],providers:[{provide:r.APP_INITIALIZER,useFactory:X,deps:[u.L10nLoader],multi:!0},{provide:p.HTTP_INTERCEPTORS,useClass:I,multi:!0},{provide:p.HTTP_INTERCEPTORS,useClass:h.AuthInterceptor,multi:!0},F,h.TerraNodeTreeConfig,h.AlertService,z],bootstrap:[b]}),i.f("design:paramtypes",[u.L10nLoader])],t)}();function X(t){return function(){return t.load()}}s.production&&Object(r.enableProdMode)(),Object(o.a)().bootstrapModule(Q).catch(function(t){return console.error(t)})}},[[1,0,5]]]);