(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{0:function(t,e){},1:function(t,e,n){t.exports=n("zUnb")},2:function(t,e){},3:function(t,e){},RnhZ:function(t,e,n){var r={"./af":"K/tc","./af.js":"K/tc","./ar":"jnO4","./ar-dz":"o1bE","./ar-dz.js":"o1bE","./ar-kw":"Qj4J","./ar-kw.js":"Qj4J","./ar-ly":"HP3h","./ar-ly.js":"HP3h","./ar-ma":"CoRJ","./ar-ma.js":"CoRJ","./ar-sa":"gjCT","./ar-sa.js":"gjCT","./ar-tn":"bYM6","./ar-tn.js":"bYM6","./ar.js":"jnO4","./az":"SFxW","./az.js":"SFxW","./be":"H8ED","./be.js":"H8ED","./bg":"hKrs","./bg.js":"hKrs","./bm":"p/rL","./bm.js":"p/rL","./bn":"kEOa","./bn.js":"kEOa","./bo":"0mo+","./bo.js":"0mo+","./br":"aIdf","./br.js":"aIdf","./bs":"JVSJ","./bs.js":"JVSJ","./ca":"1xZ4","./ca.js":"1xZ4","./cs":"PA2r","./cs.js":"PA2r","./cv":"A+xa","./cv.js":"A+xa","./cy":"l5ep","./cy.js":"l5ep","./da":"DxQv","./da.js":"DxQv","./de":"tGlX","./de-at":"s+uk","./de-at.js":"s+uk","./de-ch":"u3GI","./de-ch.js":"u3GI","./de.js":"tGlX","./dv":"WYrj","./dv.js":"WYrj","./el":"jUeY","./el.js":"jUeY","./en-SG":"zavE","./en-SG.js":"zavE","./en-au":"Dmvi","./en-au.js":"Dmvi","./en-ca":"OIYi","./en-ca.js":"OIYi","./en-gb":"Oaa7","./en-gb.js":"Oaa7","./en-ie":"4dOw","./en-ie.js":"4dOw","./en-il":"czMo","./en-il.js":"czMo","./en-nz":"b1Dy","./en-nz.js":"b1Dy","./eo":"Zduo","./eo.js":"Zduo","./es":"iYuL","./es-do":"CjzT","./es-do.js":"CjzT","./es-us":"Vclq","./es-us.js":"Vclq","./es.js":"iYuL","./et":"7BjC","./et.js":"7BjC","./eu":"D/JM","./eu.js":"D/JM","./fa":"jfSC","./fa.js":"jfSC","./fi":"gekB","./fi.js":"gekB","./fo":"ByF4","./fo.js":"ByF4","./fr":"nyYc","./fr-ca":"2fjn","./fr-ca.js":"2fjn","./fr-ch":"Dkky","./fr-ch.js":"Dkky","./fr.js":"nyYc","./fy":"cRix","./fy.js":"cRix","./ga":"USCx","./ga.js":"USCx","./gd":"9rRi","./gd.js":"9rRi","./gl":"iEDd","./gl.js":"iEDd","./gom-latn":"DKr+","./gom-latn.js":"DKr+","./gu":"4MV3","./gu.js":"4MV3","./he":"x6pH","./he.js":"x6pH","./hi":"3E1r","./hi.js":"3E1r","./hr":"S6ln","./hr.js":"S6ln","./hu":"WxRl","./hu.js":"WxRl","./hy-am":"1rYy","./hy-am.js":"1rYy","./id":"UDhR","./id.js":"UDhR","./is":"BVg3","./is.js":"BVg3","./it":"bpih","./it-ch":"bxKX","./it-ch.js":"bxKX","./it.js":"bpih","./ja":"B55N","./ja.js":"B55N","./jv":"tUCv","./jv.js":"tUCv","./ka":"IBtZ","./ka.js":"IBtZ","./kk":"bXm7","./kk.js":"bXm7","./km":"6B0Y","./km.js":"6B0Y","./kn":"PpIw","./kn.js":"PpIw","./ko":"Ivi+","./ko.js":"Ivi+","./ku":"JCF/","./ku.js":"JCF/","./ky":"lgnt","./ky.js":"lgnt","./lb":"RAwQ","./lb.js":"RAwQ","./lo":"sp3z","./lo.js":"sp3z","./lt":"JvlW","./lt.js":"JvlW","./lv":"uXwI","./lv.js":"uXwI","./me":"KTz0","./me.js":"KTz0","./mi":"aIsn","./mi.js":"aIsn","./mk":"aQkU","./mk.js":"aQkU","./ml":"AvvY","./ml.js":"AvvY","./mn":"lYtQ","./mn.js":"lYtQ","./mr":"Ob0Z","./mr.js":"Ob0Z","./ms":"6+QB","./ms-my":"ZAMP","./ms-my.js":"ZAMP","./ms.js":"6+QB","./mt":"G0Uy","./mt.js":"G0Uy","./my":"honF","./my.js":"honF","./nb":"bOMt","./nb.js":"bOMt","./ne":"OjkT","./ne.js":"OjkT","./nl":"+s0g","./nl-be":"2ykv","./nl-be.js":"2ykv","./nl.js":"+s0g","./nn":"uEye","./nn.js":"uEye","./pa-in":"8/+R","./pa-in.js":"8/+R","./pl":"jVdC","./pl.js":"jVdC","./pt":"8mBD","./pt-br":"0tRk","./pt-br.js":"0tRk","./pt.js":"8mBD","./ro":"lyxo","./ro.js":"lyxo","./ru":"lXzo","./ru.js":"lXzo","./sd":"Z4QM","./sd.js":"Z4QM","./se":"//9w","./se.js":"//9w","./si":"7aV9","./si.js":"7aV9","./sk":"e+ae","./sk.js":"e+ae","./sl":"gVVK","./sl.js":"gVVK","./sq":"yPMs","./sq.js":"yPMs","./sr":"zx6S","./sr-cyrl":"E+lV","./sr-cyrl.js":"E+lV","./sr.js":"zx6S","./ss":"Ur1D","./ss.js":"Ur1D","./sv":"X709","./sv.js":"X709","./sw":"dNwA","./sw.js":"dNwA","./ta":"PeUW","./ta.js":"PeUW","./te":"XLvN","./te.js":"XLvN","./tet":"V2x9","./tet.js":"V2x9","./tg":"Oxv6","./tg.js":"Oxv6","./th":"EOgW","./th.js":"EOgW","./tl-ph":"Dzi0","./tl-ph.js":"Dzi0","./tlh":"z3Vd","./tlh.js":"z3Vd","./tr":"DoHr","./tr.js":"DoHr","./tzl":"z1FC","./tzl.js":"z1FC","./tzm":"wQk9","./tzm-latn":"tT3J","./tzm-latn.js":"tT3J","./tzm.js":"wQk9","./ug-cn":"YRex","./ug-cn.js":"YRex","./uk":"raLr","./uk.js":"raLr","./ur":"UpQW","./ur.js":"UpQW","./uz":"Loxo","./uz-latn":"AQ68","./uz-latn.js":"AQ68","./uz.js":"Loxo","./vi":"KSF8","./vi.js":"KSF8","./x-pseudo":"/X5v","./x-pseudo.js":"/X5v","./yo":"fzPg","./yo.js":"fzPg","./zh-cn":"XDpg","./zh-cn.js":"XDpg","./zh-hk":"SatO","./zh-hk.js":"SatO","./zh-tw":"kOpN","./zh-tw.js":"kOpN"};function i(t){var e=o(t);return n(e)}function o(t){var e=r[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}i.keys=function(){return Object.keys(r)},i.resolve=o,t.exports=i,i.id="RnhZ"},VcIq:function(t,e){t.exports=""},crnd:function(t,e){function n(t){return Promise.resolve().then(function(){var e=new Error("Cannot find module '"+t+"'");throw e.code="MODULE_NOT_FOUND",e})}n.keys=function(){return[]},n.resolve=n,t.exports=n,n.id="crnd"},e9d7:function(t,e){t.exports='<div [class]="isBigDiv ? \'big-div\' : \'normal-div\'">\r\n    <label *ngIf="label !== \'\'" for="{{namePrefix}}">{{label}}</label>\r\n    <select #select name="{{namePrefix}}" (change)="onChange()" (focus)="savePrev()">\r\n        <option [selected]="initial == item.id" *ngFor="let item of data" value="{{item.id}}">{{item.name}} ({{item.id}})</option>\r\n    </select>\r\n</div>\r\n'},iJlf:function(t,e){t.exports="label {\n  max-width: 100px;\n  height: 30px;\n  margin-right: 10px; }\n\nselect {\n  width: 200px;\n  height: 25px;\n  float: right; }\n\n.big-div {\n  max-width: 330px; }\n\n.normal-div {\n  width: 200px; }\n\ninput {\n  margin: 0px !important; }\n"},"k/xC":function(t,e){t.exports="<router-outlet></router-outlet>\r\n"},oyxX:function(t,e){t.exports='<div class="container-fluid">\r\n    <span class="version_span"><b>AmaVat {{pluginVersion}}</b></span>\r\n    <div class="row">\r\n        <div class="form-div">\r\n            <label for="dateFrom">Month:</label>\r\n            <input type="month" name="date" #dateFrom="ngModel" [ngModel]="model.date | date:\'yyyy-MM\'" (ngModelChange)="model.date = $event" required>\r\n            <div *ngIf="dateFrom.invalid && (dateFrom.dirty || dateFrom.touched)" class="validation-error">\r\n                <div *ngIf="dateFrom.errors.required">Month is required.</div>\r\n            </div>\r\n        </div>\r\n        <br />\r\n    </div>\r\n\r\n    <div class="row">\r\n        <div class="form-div store-div">\r\n            <dropdown [label]="\'Store\'" [initial]="0" [data]="webstores" (selected)="setStore($event)"></dropdown>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="row">\r\n        <div class="form-div store-div">\r\n            <dropdown [label]="\'Country\'" [initial]="1" [data]="countries" (selected)="setCountry($event)"></dropdown>\r\n        </div>\r\n    </div>\r\n\r\n    <div class="row">\r\n        <div class="form-div">\r\n            <label>Order status:</label>\r\n            <br />\r\n            <ng-multiselect-dropdown [placeholder]="\'Select status\'"\r\n                                     [settings]="dropdownSettings"\r\n                                     [data]="statuses"\r\n                                     [(ngModel)]="model.selectedItems"\r\n                                     name="statusDropdown"\r\n                                     #statusDropdown="ngModel"\r\n                                     required>\r\n            </ng-multiselect-dropdown>\r\n            <div *ngIf="statusDropdown.invalid && (statusDropdown.dirty || statusDropdown.touched)" class="validation-error">\r\n                <div *ngIf="statusDropdown.errors.required">Status is required.</div>\r\n            </div>\r\n            <div class="validation-error" *ngIf="showStatusError">You have to select at least one status</div>\r\n        </div>\r\n        <br />\r\n    </div>\r\n\r\n    <div class="form-div center-text button-div">\r\n        <button class="button" (click)="generate()">Generate</button>\r\n    </div>\r\n\r\n    <div class="form-div center-text">\r\n        <label class="status" style="color:orange" *ngIf="isGenerating && !isGenerated">{{status}}</label>\r\n        <label class="status" style="color:green" *ngIf="isGenerated">Generated</label>\r\n        <label class="status" style="color:red" *ngIf="errorOccured">{{errorMessage}}</label>\r\n    </div>\r\n</div>\r\n'},ygTa:function(t,e){t.exports=".version_span {\n  margin-left: 30px;\n  font-size: medium;\n  margin-bottom: -40px; }\n\n.form-div {\n  width: 30%;\n  margin: auto;\n  margin-top: 15px; }\n\n.form-div > input {\n    float: right;\n    width: 70%;\n    margin: 10px; }\n\n.form-div > select {\n    float: right;\n    width: 70%;\n    margin: 10px; }\n\n.form-div > label {\n    width: auto;\n    margin: 10px;\n    margin-bottom: 0px; }\n\n.status {\n  width: 80% !important;\n  margin: -1px;\n  margin-top: 20px;\n  text-align: center; }\n\n.validation-error {\n  color: red;\n  text-align: right; }\n\n.ml-20 {\n  margin-left: 20px; }\n\n.button {\n  margin: 10px;\n  width: 10%; }\n\n.center-text {\n  text-align: center; }\n\n.button-div {\n  width: 100%;\n  display: -webkit-box;\n  display: flex;\n  -webkit-box-pack: center;\n          justify-content: center; }\n\n.container-fluid {\n  margin: 10px;\n  width: 90%; }\n\n::ng-deep .big-div {\n  width: 100% !important;\n  max-width: 100% !important; }\n\n::ng-deep .big-div select {\n    width: 70% !important;\n    margin: 10px !important; }\n\n::ng-deep .big-div label {\n    margin: 10px !important; }\n"},zUnb:function(t,e,n){"use strict";n.r(e);var r=n("CcnG"),i=n("ToYH"),o={production:!0},s=n("mrSG"),a=n("ZYjt"),u=n("sE5F"),c=n("up6G"),d=n("gIcY"),l=function(){var t=localStorage.getItem("plentymarkets_lang_"),e=null;null!==t?e=t:("de"!==(e=navigator.language.slice(0,2).toLocaleLowerCase())&&"en"!==e&&(e="en"),localStorage.setItem("plentymarkets_lang_",e));return{locale:{languages:[{code:"en",dir:"ltr"},{code:"de",dir:"ltr"}],language:e,storage:c.StorageStrategy.Cookie},translation:{providers:[{type:c.ProviderType.Static,prefix:"assets/lang/locale-"},{type:c.ProviderType.Static,prefix:"assets/lang/terra-components/locale-"}],caching:!0,composedKeySeparator:".",i18nPlural:!1}}}();var p=n("t/Na"),h=n("ZYCi"),f=n("MnON"),m=n("wFw1"),g=function(t){function e(e,n,r){var i=t.call(this,new p.HttpClient(e),n,r)||this;return i.httpBackend=e,i}return s.d(e,t),e=s.c([Object(r.Injectable)(),s.g(1,Object(r.Inject)(c.L10N_CONFIG)),s.f("design:paramtypes",[p.HttpBackend,Object,c.Caching])],e)}(c.L10nTranslationProvider),y=n("XlPw"),v=n("5tAl"),j=n("9Z1F"),I=function(){function t(){}return t.prototype.intercept=function(t,e){return e.handle(t).pipe(Object(v.a)(1),Object(j.a)(function(t){var e="";return e=t.error instanceof ErrorEvent?"Error: "+t.error.message:"Error Code: "+t.status+"\nMessage: "+t.message,console.log(e),Object(y.a)(e)}))},t}(),b=function(){function t(){this.accessToken="eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9.eyJhdWQiOiIxIiwianRpIjoiNTU0ZjlkNDAzMmFkY2Y3M2VjMmM0NGRlZGQwNGI4Y2NmMjVkZjY3MmZhOWMwNTZmOTE2ODlmNjE0MDE1ZDRiNDlmZTFhZjBkOWZkMTg3ZDAiLCJpYXQiOjE2MzE3NzQ4MjAsIm5iZiI6MTYzMTc3NDgyMCwiZXhwIjoxNjMxODYxMjIwLCJzdWIiOiI1NyIsInNjb3BlcyI6WyIqIl19.OyXzLMl6HAMXksiXixDpcRx0L4gM7oUfNc-gsl44CKWbwGlN5Iu_UCPEMJZVx3yF2Sy5Oon4p_T_HvLPW0KfNHGpD9jED5-pYkhFtdeFOqYf0KGFyzbBaMuGIwuXjUiDK_BYWIzgZW7V00maZPce__tL-KIK2TjnabYyUfqJrkVW5ZnfCKRzr87OTOwOUGeUpjvvNfDHsswYvmjkKlkyiYuovM84Lpsl9-706mcqRvVXjhSy-Zv34Y9aLBMJpQSNypQND0nDd3aUx9nu_AwJwQ2EtAGdB27pe511a5dLlnmGtB0TSMnM641FXHmi90r1Q61omNRXEQvXZaDbjMPUkQxk92lOJnt5eoCQ9GGORLHW8WLQ_DB8WdLkDLv-mCQjs-KM_0mGBms3cISnnCx-ZsHaKVfXrJd-SkoeyfVGg78v2kATwwQTNHcG2yjbXWaA4urH_SKwGX-Qh91sae4GV0TvKbQY0fmdzL2PFej9sjletlKfAyc9mvRun0KbHMvKRjowDtoiMGiaLAiUo2gZpp8PyTmUOPDXDXEuqbf-AcDeLKbMmCUypt9EzmruaXLS0Bxgl8aNHXG_Xaitv18DETchMkZDISkFXCiIikXHIMVdCzjsNd3A8N44gFAa05y1sjO2RinV01rIDkv3nQQ6fnRAY7gwXkjrKH7ucwq4s7g"}return t.prototype.ngOnInit=function(){o.production||localStorage.setItem("accessToken",this.accessToken)},t=s.c([Object(r.Component)({selector:"ptb-app",template:n("k/xC"),styles:[n("VcIq")]}),s.f("design:paramtypes",[])],t)}(),C=(function(){}(),function(){return function(){this.selectedItems=new Array}}()),S=(function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(){}(),function(t){function e(){return null!==t&&t.apply(this,arguments)||this}s.d(e,t)}(function(){return function(){}}()),n("EUZL")),O=function(){return function(){}}(),w=function(){function t(){}return t.DATE_FORMAT="yyyy-MM-dd",t.PERIOD_DATE_FORMAT="yyyy-MM",t.MAX_ITEMS_PER_PAGE=250,t.SHIPPING_ADDRESS_TYPE_ID=2,t.DATE_LOCALE="pl-PL",t.ORIGINAL_ORDER_TYPE_ID=-999,t.USED_DOCUMENTS=["invoice","invoice_external","pos_invoice","credit_note","pos_invoice_cancellation","refund_reversal","reversal_document"],t.SELL_DOCUMENTS=["invoice","invoice_external","pos_invoice"],t.REFUND_DOCUMENTS=["credit_note","pos_invoice_cancellation","refund_reversal","reversal_document"],t.TAX_COLLECTION_RESPONSIBILITY="SELLER",t.TYPE_SERVICE_PROVISION="Goods",t.SENT_FROM_ZIP="",t.PURCHASE_PRICE="",t}(),D=n("Ip0R");function E(t,e){void 0===e&&(e=w.DATE_FORMAT);try{return Object(D.formatDate)(t,e,w.DATE_LOCALE)}catch(n){return"<Invalid Date>"+t}}function T(t,e){var n=t.addressRelations.filter(function(t){return t.typeId===e});if(n.length>0){var r=t.addresses.filter(function(t){return t.id===n[0].addressId});return r.length>0?r[0]:void 0}}function P(t){var e=T(t,w.SHIPPING_ADDRESS_TYPE_ID);return e?e.countryId:-1}function x(t){switch(t){case 2:return"AT";case 3:return"BE";case 44:return"BG";case 54:return"HR";case 5:return"CY";case 6:return"CZ";case 7:return"DK";case 9:return"EE";case 10:return"FR";case 11:return"FI";case 1:return"DE";case 13:return"GR";case 14:return"HU";case 15:return"IT";case 16:return"IE";case 18:return"LV";case 33:return"LT";case 17:return"LU";case 19:return"MT";case 21:return"AW";case 23:return"Pl";case 22:return"PT";case 41:return"RO";case 26:return"SK";case 27:return"SI";case 8:return"ES";case 24:return"SE";case 12:return"UK";case 31:return"CN";case 37:return"IC";case 203:return"QA";case 4:return"CH";case 0:return"Unknown";default:return""+t}}function A(t,e){var n=t.dates.filter(function(t){return t.typeId==e});return 0==n.length?"":E(n[0].date)}function M(t,e,n,r,i,o,s,a,u){var c=new O;c.period=E(new Date(n),"yyyy-MM"),c.transactionChannel=t.referrerId.toString(),c.transactionNumber=t.id.toString();var d,l=w.SELL_DOCUMENTS.indexOf(r.type)>-1;c.transactionType=l?"SALE":"REFUND",c.typeServiceProvision=w.TYPE_SERVICE_PROVISION,c.sentFromCountry=x((d=t).warehouseSender&&d.warehouseSender.address?d.warehouseSender.address.countryId:-1),c.sentFromZIP="",c.sentToCountry=x(P(t));var p=T(t,w.SHIPPING_ADDRESS_TYPE_ID);if(c.sentToZIP=p?p.postalCode:"",c.documentDate=E(r.displayDate),c.documentNumber=r.numberWithPrefix,l)c.correctedDocumentNo="",c.correctedDocumentDate="";else{var h=t.orderReferences.length>0?t.orderReferences[0].originOrderId:void 0,f=i.filter(function(t){return t.id==h});if(f.length>0)if(f[0].documents.filter(function(t){return w.SELL_DOCUMENTS.indexOf(t.type)>-1}).length>0){var m=f[0].documents.filter(function(t){return"invoice"==t.type}).sort(function(t,e){return new Date(e.displayDate).getTime()-new Date(t.displayDate).getTime()}).slice(-1)[0];c.correctedDocumentNo=m.numberWithPrefix,c.correctedDocumentDate=E(m.displayDate)}else 0==f[0].documents.filter(function(t){return"invoice"==t.type}).length?(c.correctedDocumentNo="[Original order does not have invoice]",c.correctedDocumentDate="[Original order does not have invoice]"):(c.correctedDocumentNo="[wtf]",c.correctedDocumentDate="[wtf]");else c.correctedDocumentNo="[Unable to find original order]",c.correctedDocumentDate=c.documentDate}c.transactionOrderDate=A(t,2),c.transactionShipmentDate=A(t,5),c.transactionPaymentDate=A(t,3),c.transactionDeliveryDate=A(t,8),e.variation?c.itemUnit=e.variation.name:c.itemUnit="",c.itemQuantity=e.quantity,e.variation?c.itemNumber=e.variation.number:c.itemNumber="",c.itemDescription=e.orderItemName;var g=e.amounts.length>0?e.amounts[0]:void 0;if(g){c.totalPriceofItems=l?e.quantity*g.priceGross:-1*e.quantity*g.priceGross,c.taxableBenefits1=0,c.taxableBenefits2=0,c.totalTransactionValue=c.totalPriceofItems,c.transactionCurrency=g.currency;var y=t.amounts.length>0&&t.amounts[0].vats.length>0?t.amounts[0].vats[0]:void 0;y&&(c.vATRate=y.vatRate)}c.purchasePrice="";var v=t.contactReceiver,j=T(t,w.SHIPPING_ADDRESS_TYPE_ID),I="",b="";if(v.accounts&&1===v.accounts.length){var C=v.accounts[0];I=null!=C.companyName?C.companyName+" ":"",b=C.taxIdNumber}if(c.buyerName?I+=v.firstName+" "+v.lastName:I=v.firstName+" "+v.lastName,c.buyerName=I,c.buyerAddress1=j.address1,c.buyerAddress2=j.address2,c.buyerZIP=j.postalCode,c.buyerCity=j.town,c.buyerCounty=j.stateId,c.buyerCountry=x(j.countryId),!j||j.countryId!=u)return null;if(c.buyerVatId=b,e.variation){c.commodityCode=e.variation.customsTariffNumber,c.weight=e.variation.weightNetG.toString();var S=a.filter(function(t){return t.id==e.variation.itemId});S.length>0?c.countryOfOrigin=x(S[0].producingCountryId):c.countryOfOrigin=""}else c.commodityCode="",c.weight="",c.countryOfOrigin="";if(c.commodityCode&&""!=c.commodityCode||(c.commodityCode="99999999050"),c.incotermsCode="",s=s.filter(function(e){return null==e.invalidFrom||new Date(e.invalidFrom).getTime()<new Date(t.createdAt).getTime()}),c.sellerVatId=function(t,e){var n=Number(t.locationId),r=P(t),i=e.filter(function(t){return t.countryId===r&&t.locationId===n}).sort(function(t,e){return new Date(e.startedAt).getTime()-new Date(t.startedAt).getTime()});return i.length>0?i[0].taxIdNumber:""}(t,s),t.location){var D=o.filter(function(e){return e.id==t.location.clientId});D.length>0?c.sellerName=D[0].name:c.sellerName=""}else c.sellerName="";return"PURCHASE"!=c.transactionType&&(c.sellerName="",c.sellerVatId=""),c.taxCollectionResponsibility=w.TAX_COLLECTION_RESPONSIBILITY,c}function _(t,e,n,r,i,o,s,a,u){var c=function(t,e,n,r,i,o,s,a){var u=new Array;return r.setHours(23,59,59),t.filter(function(t){return t.typeId!=w.ORIGINAL_ORDER_TYPE_ID}).forEach(function(c){c.documents.filter(function(t){return w.USED_DOCUMENTS.indexOf(t.type)>-1&&new Date(t.displayDate)>=n&&new Date(t.displayDate)<=r}).forEach(function(n){c.orderItems.forEach(function(r){u.push(M(c,r,e,n,t,i,o,s,a))})})}),u.filter(function(t){return null!=t})}(e.filter(function(t){return t.location&&t.location.clientId==a}),t,n,r,i,o,s,u),d=S.utils.book_new();S.utils.sheet_add_aoa(d,[["Period","TransactionChannel","TransactionNumber","TransactionType","TypeServiceProvision","SentFromCountry","SentFromZIP","SentToCountry","SentToZIP","DocumentDate","DocumentNumber","CorrectedDocumentNo","CorrectedDocumentDate","TransactionOrderDate","TransactionShipmentDate","TransactionPaymentDate","TransactionDeliveryDate","ItemUnit","ItemQuantity","ItemNumber","ItemDescription","TotalPriceofItems","TaxableBenefits1","TaxableBenefits2","TotalTransactionValue","TransactionCurrency","VATRate","PurchasePrice","BuyerName","BuyerAddress1","BuyerAddress2","BuyerZIP","BuyerCity","BuyerCounty","BuyerCountry","BuyerVAT-ID-No","CommodityCode","Weight","CountryOfOrigin","IncotermsCode","SellerVAT-ID-No","SellerName","TaxCollectionResponsibility"]]),S.utils.sheet_add_json(d,c,{origin:"A2",skipHeader:!0});var l=S.utils.book_new();S.utils.book_append_sheet(l,d,t);var p,h,f,m,g=l.Sheets[l.SheetNames[0]],y=S.utils.sheet_to_csv(g,{FS:";"});p=y,h=t+".csv",f="text/csv;encoding:utf-8",m=document.createElement("a"),f=f||"application/octet-stream",navigator.msSaveBlob?navigator.msSaveBlob(new Blob([p],{type:f}),h):URL&&"download"in m?(m.href=URL.createObjectURL(new Blob([p],{type:f})),m.setAttribute("download",h),document.body.appendChild(m),m.click(),document.body.removeChild(m)):location.href="data:application/octet-stream,"+encodeURIComponent(p)}var R=n("BAOO"),N=n.n(R),k=n("VNr4");function U(t){var e=t.getFullYear(),n=t.getMonth(),r=(++n).toString();n<10&&(r="0"+n);var i=t.getDate(),o=i.toString();i<10&&(o="0"+i);var s=t.getHours(),a=s.toString();s<10&&(a="0"+s);var u=t.getMinutes(),c=u.toString();u<10&&(c="0"+u);var d=t.getSeconds(),l=d.toString();d<10&&(l="0"+d);var p=-t.getTimezoneOffset(),h=Math.abs(Math.floor(p/60)),f=h.toString();h<10&&(f="0"+h);var m=Math.abs(p)-60*h,g=m.toString();m<10&&(g="0"+m);var y="+";return p<0&&(y="-"),e+"-"+r+"-"+o+"T"+a+":"+c+":"+l+y+f+":"+g}var G=n("xMyE"),L=function(){function t(t){this.httpClient=t,this.TestBaseUrl="https://6ost41vkg5r1.plentymarkets-cloud01.com/rest/",this.PlentyBaseUrl="",o.production?this.PlentyBaseUrl=this.preparePlentyBaseUrl():this.PlentyBaseUrl=this.TestBaseUrl}return t.prototype.getOrderData=function(t,e,n,r,i,o,s,a,u){return void 0===a&&(a=!1),void 0===u&&(u=!1),this.getFromApi(this.prepareOrderUrl(i,o,n,r,t,e,s,a)).pipe(Object(G.a)(function(t){t.isUpdatedAt=a,t.isCreditNote=u}))},t.prototype.getWebstores=function(){return this.getFromApi("webstores")},t.prototype.getPaymentMethodList=function(){return this.getFromApi("payments/methods")},t.prototype.getOrderReferrerList=function(){return this.getFromApi("orders/referrers")},t.prototype.getOrderByIdv2=function(t){return this.httpClient.get(this.getMethodUrl("orders/"+t+"?with[]=documents&with[]=addresses&with[]=contactReceiver&with[]=warehouseSender&with[]=payments&with[]=orderItems.variation"),{responseType:"json"})},t.prototype.getOrderById=function(t){return this.getFromApi("orders/"+t+"?with[]=documents&with[]=addresses&with[]=contactReceiver&with[]=warehouseSender&with[]=payments&with[]=orderItems.variation&with[]=contactSender&with[]=location&with[]=shippingInformation")},t.prototype.getVatConfigs=function(){return this.getFromApi("vat?itemsPerPage="+w.MAX_ITEMS_PER_PAGE)},t.prototype.getItems=function(t){return this.getFromApi("items?itemsPerPage="+w.MAX_ITEMS_PER_PAGE+"&page="+t)},t.prototype.getStatuses=function(){return this.getFromApi("orders/statuses/all")},t.prototype.preparePlentyBaseUrl=function(){var t=window.location.href.split("/");return t[0]+"//"+t[2]+"/rest/"},t.prototype.getFromApi=function(t){return this.httpClient.get(this.getMethodUrl(t),{responseType:"json"})},t.prototype.getMethodUrl=function(t){return""+this.PlentyBaseUrl+t},t.prototype.prepareOrderUrl=function(t,e,n,r,i,o,s,a){var u="orders?page="+t+"&itemsPerPage="+e;return r.setHours(23,59,59),u+=a?"&updatedAtFrom="+encodeURIComponent(U(n))+"&updatedAtTo="+encodeURIComponent(U(r)):"&createdAtFrom="+encodeURIComponent(U(n))+"&createdAtTo="+encodeURIComponent(U(r)),u+="&statusTo="+o+"&statusFrom="+i,u+="&clientId="+s,u+="&with[]=addresses",u+="&with[]=documents",u+="&with[]=contactReceiver",u+="&with[]=warehouseSender",u+="&with[]=payments",u+="&with[]=orderItems.variation",u+="&with[]=location"},t=s.c([Object(r.Injectable)(),s.f("design:paramtypes",[p.HttpClient])],t)}(),F=n("HJBe"),B=function(){function t(t,e,n){this.alertService=t,this.ngZone=e,this.amaService=n,this.pluginVersion="0.9.6",this.model=new C,this.isGenerating=!1,this.isGenerated=!1,this.errorOccured=!1,this.expectedOrderCount=0,this.expectedItemCount=0,this.errorMessage="",this.status="Getting orders...",this.orders=new Array,this.dropdownSettings={},this.statuses=new Array,this.webstores=new Array,this.vatConfigs=new Array,this.items=new Array,this.countries=this.getCountriesForDropdown(),this.isLoading=!0}return t.prototype.ngOnInit=function(){var t=this;this.amaService.getVatConfigs().subscribe(function(e){t.vatConfigs=e.entries}),this.amaService.getWebstores().subscribe(function(e){return t.webstores=e}),this.getStatusList(),this.setStatusDropdownSettings(),Object(D.registerLocaleData)(N.a);var e=new Date;this.model.date=e.getFullYear()+"-"+(e.getMonth()+1),this.clientId=0,this.countryId=1},t.prototype.setStore=function(t){this.clientId=t.id},t.prototype.setCountry=function(t){this.countryId=t.id},t.prototype.generate=function(){this.setGeneratingVariables(),this.isGenerating=!0,this.PrepareAllItems()},t.prototype.PrepareAllItems=function(){var t=this,e=new Array;this.updateStatus(void 0,!0),this.amaService.getItems(1).subscribe(function(n){if(t.expectedItemCount=n.totalsCount,t.items=t.items.concat(n.entries),t.expectedItemCount>w.MAX_ITEMS_PER_PAGE)for(var r=n.lastPageNumber,i=2;i<=r+1;i++)e.push(t.amaService.getItems(i).pipe(Object(G.a)(function(e){t.items=t.items.concat(e.entries)},function(){},function(){return t.updateStatus(void 0,!0)})));Object(k.a)(e).pipe(Object(F.a)(null)).subscribe(function(){t.updateStatus(),t.getAllOrdersAndGenerateExcel()})})},t.prototype.getAllOrdersAndGenerateExcel=function(){var t=this,e=new Date(this.model.date+"-1"),n=new Date(e.getFullYear(),e.getMonth()+1,0),r=[],i=this.getStatusFrom().id,o=this.getStatusTo().id,a=[],u=this.addDays(e,-10),c=this.addDays(n,10),d=!1;o>=11.1&&(d=!0),a.push(this.amaService.getOrderData(i,o,u,c,1,w.MAX_ITEMS_PER_PAGE,this.clientId)),a.push(this.amaService.getOrderData(i,o,u,c,1,w.MAX_ITEMS_PER_PAGE,this.clientId,!0)),d&&a.push(this.amaService.getOrderData(11.1,11.1,e,n,1,w.MAX_ITEMS_PER_PAGE,this.clientId,!0,!0)),Object(k.a)(a).pipe(Object(F.a)(null)).subscribe(function(a){a.forEach(function(e){if(t.expectedOrderCount+=e.totalsCount,t.orders=t.orders.concat(e.entries),e.totalsCount>w.MAX_ITEMS_PER_PAGE){var n=Math.ceil((e.totalsCount-w.MAX_ITEMS_PER_PAGE)/w.MAX_ITEMS_PER_PAGE);e.isUpdatedAt?e.isCreditNote?t.getRestOfOrders(11.1,11.1,u,c,n,w.MAX_ITEMS_PER_PAGE,!0).pipe(Object(F.a)(null)):r.push(t.getRestOfOrders(i,o,u,c,n,w.MAX_ITEMS_PER_PAGE,!0).pipe(Object(F.a)(null))):r.push(t.getRestOfOrders(i,o,u,c,n,w.MAX_ITEMS_PER_PAGE).pipe(Object(F.a)(null)))}}),Object(k.a)(r).pipe(Object(F.a)(null)).subscribe(function(){t.hasDuplicates(t.orders)&&(t.orders=t.orders.filter(function(t,e,n){return n.findIndex(function(e){return e.id===t.id})===e}));var r=t.model.selectedItems.map(function(t){return t.id}),i=t.orders.filter(function(t){return r.indexOf(t.statusId)>-1});t.updateStatus("Getting original orders for credit notes");var o=i.filter(function(t){return t.documents.filter(function(e){return w.REFUND_DOCUMENTS.indexOf(e.type)>-1&&t.orderReferences.length>0}).length>0}).map(function(t){return t.orderReferences[0].originOrderId});o=o.filter(function(t){return-1===i.indexOf(t)}),s.b(t,void 0,void 0,function(){var t,e,n=this;return s.e(this,function(r){switch(r.label){case 0:t=function(){var t,r;return s.e(this,function(s){switch(s.label){case 0:return t=o.slice(0,150),r=[],t.forEach(function(t){r.push(n.amaService.getOrderByIdv2(t).toPromise())}),[4,Promise.all(r).finally(function(){n.updateStatus("Getting original orders for credit notes ("+o.length+" left)")})];case 1:return s.sent().forEach(function(t){var e=t;o=o.filter(function(t){return t!=e.id}),e.typeId=w.ORIGINAL_ORDER_TYPE_ID,i.push(e)}),o.length>0?[4,e.delay(6e4,o.length)]:[3,3];case 2:s.sent(),s.label=3;case 3:return[2]}})},e=this,r.label=1;case 1:return o.length>0?[5,t()]:[3,3];case 2:return r.sent(),[3,1];case 3:return[2]}})}).then(function(){if(t.updateStatus("Generating csv"),0!==i.length){t.hasDuplicates(i)&&(i=i.filter(function(t,e,n){return n.findIndex(function(e){return e.id===t.id})===e}));try{_(t.model.date,i,e,n,t.webstores,t.vatConfigs,t.items,t.clientId,t.countryId),t.isGenerating=!1,t.isGenerated=!0,t.orders=new Array,t.expectedOrderCount=0}catch(r){t.setError("Unhandled exception occured in excel generation",r)}}else t.setError("No orders found")})},function(t){throw console.log(t),t})},function(){return t.setError("Error fetching orders")},function(){return t.updateStatus()})},t.prototype.delay=function(t,e){return this.updateStatus("Waiting "+t/1e3+" sec to avoid API throtling ("+e+" orders left)"),new Promise(function(e){return setTimeout(e,t)})},t.prototype.addDays=function(t,e){var n=new Date(t);return n.setDate(n.getDate()+e),n},t.prototype.setGeneratingVariables=function(){this.isGenerating=!1,this.isGenerated=!1,this.errorOccured=!1,this.errorMessage=""},t.prototype.setStatusDropdownSettings=function(){this.dropdownSettings={singleSelection:!1,idField:"id",textField:"text",selectAllText:"Select all",unSelectAllText:"Unselect all",itemsShowLimit:15,allowSearchFilter:!1}},t.prototype.getStatusList=function(){var t=this;this.amaService.getStatuses().subscribe(function(e){var n=e.sort(function(t,e){return t.statusId-e.statusId}),r=[];n.forEach(function(e){r.push({id:e.statusId,text:t.getStatusNameString(e)})}),t.statuses=r},function(){t.setError("Unable to get status list form API")})},t.prototype.getStatusTo=function(){return this.model.selectedItems.sort(function(t,e){return e.id-t.id})[0]},t.prototype.getStatusFrom=function(){return this.model.selectedItems.sort(function(t,e){return t.id-e.id})[0]},t.prototype.getRestOfOrders=function(t,e,n,r,i,o,s){var a=this;void 0===s&&(s=!1);for(var u=[],c=1;c<=i;c++)u.push(this.amaService.getOrderData(t,e,n,r,1+c,o,this.clientId,s).pipe(Object(G.a)(function(t){a.orders=a.orders.concat(t.entries)},function(){},function(){return a.updateStatus()})));return Object(k.a)(u)},t.prototype.hasDuplicates=function(t){var e=new Set;return t.some(function(t){return e.size===e.add(t.id).size})},t.prototype.setError=function(t,e){void 0===e&&(e=void 0),this.setGeneratingVariables(),this.errorOccured=!0,this.errorMessage=t,this.alertService.error(t),e&&console.log(e)},t.prototype.updateStatus=function(t,e){var n=this;if(void 0===t&&(t=void 0),void 0===e&&(e=!1),t)this.ngZone.run(function(){n.status=t});else if(e){0!==this.expectedItemCount&&Math.round(this.items.length/this.expectedItemCount*100);this.ngZone.run(function(){n.status=0!==n.expectedItemCount?"Getting items... ("+n.items.length+")":"Getting items..."})}else{var r=0!==this.expectedOrderCount?Math.round(this.orders.length/this.expectedOrderCount*100):0;this.ngZone.run(function(){n.status=0!==n.expectedOrderCount?"Getting orders... ("+r+"%)":"Getting orders..."})}},t.prototype.getStatusNameString=function(t){return t.names.en?t.names.en:t.names.de},t.prototype.getCountriesForDropdown=function(){var t=new Array;return t.push(this.getCountry(1,"Germany")),t.push(this.getCountry(2,"Austria")),t.push(this.getCountry(3,"Belgium")),t.push(this.getCountry(4,"Switzerland")),t.push(this.getCountry(5,"Cyprus")),t.push(this.getCountry(6,"Czech Republic")),t.push(this.getCountry(7,"Denmark")),t.push(this.getCountry(8,"Spain")),t.push(this.getCountry(9,"Estonia")),t.push(this.getCountry(10,"France")),t.push(this.getCountry(11,"Finland")),t.push(this.getCountry(12,"United Kingdom")),t.push(this.getCountry(13,"Greece")),t.push(this.getCountry(14,"Hungary")),t.push(this.getCountry(15,"Italy")),t.push(this.getCountry(16,"Ireland")),t.push(this.getCountry(17,"Luxembourg")),t.push(this.getCountry(18,"Latvia")),t.push(this.getCountry(19,"Malta")),t.push(this.getCountry(20,"Norway")),t.push(this.getCountry(21,"Netherlands")),t.push(this.getCountry(22,"Portugal")),t.push(this.getCountry(23,"Poland")),t.push(this.getCountry(24,"Sweden")),t.push(this.getCountry(54,"Croatia")),t.push(this.getCountry(44,"Bulgaria")),t.push(this.getCountry(33,"Lithuania")),t.push(this.getCountry(265,"Northern Ireland")),t.push(this.getCountry(41,"Romania")),t.push(this.getCountry(33,"Lithuania")),t.push(this.getCountry(26,"Slovakia")),t.push(this.getCountry(27,"Slovenia")),t.push(this.getCountry(203,"Qatar")),t.push(this.getCountry(37,"Canary Islands")),t},t.prototype.getCountry=function(t,e){return{id:t,plentyId:t,name:e}},t=s.c([Object(r.Component)({selector:"amavat",template:n("oyxX"),styles:[n("ygTa")]}),s.f("design:paramtypes",[f.AlertService,r.NgZone,L])],t)}(),z=[{path:"",component:B}],V=[],X=h.RouterModule.forRoot(z,{useHash:!0}),Y=n("5NQ/"),Z=n("SMsm"),H=function(){function t(){this.label="",this.namePrefix="dropdown",this.data=new Array,this.selected=new r.EventEmitter,this.forcePrevious=0,this.previousValue=-1}return t.prototype.ngOnInit=function(){this.previousValue=this.initial},Object.defineProperty(t.prototype,"isBigDiv",{get:function(){return""!=this.label},enumerable:!0,configurable:!0}),t.prototype.onChange=function(){var t=this;this.selected.emit(this.data.filter(function(e){return e.id==t.select.nativeElement.value})[0])},t.prototype.savePrev=function(){this.previousValue=this.select.nativeElement.value},t.prototype.ngOnChanges=function(t){t.forcePrevious&&!t.forcePrevious.firstChange&&(this.select.nativeElement.value=this.previousValue)},s.c([Object(r.Input)(),s.f("design:type",Object)],t.prototype,"label",void 0),s.c([Object(r.Input)(),s.f("design:type",Object)],t.prototype,"namePrefix",void 0),s.c([Object(r.Input)(),s.f("design:type",Number)],t.prototype,"initial",void 0),s.c([Object(r.Input)(),s.f("design:type",Array)],t.prototype,"data",void 0),s.c([Object(r.Output)(),s.f("design:type",Object)],t.prototype,"selected",void 0),s.c([Object(r.ViewChild)("select"),s.f("design:type",r.ElementRef)],t.prototype,"select",void 0),s.c([Object(r.Input)(),s.f("design:type",Object)],t.prototype,"forcePrevious",void 0),t=s.c([Object(r.Component)({selector:"dropdown",template:n("e9d7"),styles:[n("iJlf")]})],t)}(),Q=function(){function t(t){this.l10nLoader=t,this.l10nLoader.load()}return t=s.c([Object(r.NgModule)({imports:[a.a,m.b,u.HttpModule,d.FormsModule,p.HttpClientModule,c.TranslationModule.forRoot(l,{translationProvider:g}),h.RouterModule.forRoot([]),f.TerraComponentsModule,X,Z.a,Y.a.forRoot()],declarations:[b,B,H],providers:[{provide:r.APP_INITIALIZER,useFactory:K,deps:[c.L10nLoader],multi:!0},{provide:p.HTTP_INTERCEPTORS,useClass:I,multi:!0},{provide:p.HTTP_INTERCEPTORS,useClass:f.AuthInterceptor,multi:!0},V,f.TerraNodeTreeConfig,f.AlertService,L],bootstrap:[b]}),s.f("design:paramtypes",[c.L10nLoader])],t)}();function K(t){return function(){return t.load()}}o.production&&Object(r.enableProdMode)(),Object(i.a)().bootstrapModule(Q).catch(function(t){return console.error(t)})}},[[1,0,5]]]);